# Requirements Archive: v1.1 Production Hardening

**Archived:** 2026-02-03
**Status:** âœ… SHIPPED

This is the archived requirements specification for v1.1.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

# Requirements: OpenNebula Helm Chart

**Defined:** 2025-01-23
**Core Value:** A production-ready, self-updating OpenNebula deployment on Kubernetes that the community can use out of the box.

## v1 Requirements

Requirements for initial release. Each maps to roadmap phases.

### Docker Image

- [x] **IMG-01**: Docker image uses Ubuntu 24.04 LTS as base
- [x] **IMG-02**: OpenNebula 7.0 packages installed and functional
- [x] **IMG-03**: Services start without systemd (manual/entrypoint management)
- [x] **IMG-04**: Configuration via environment variables (DB connection, passwords, etc.)
- [x] **IMG-05**: Services included: oned, Sunstone, FireEdge, OneFlow, OneGate

### CI/CD Pipeline

- [x] **CI-01**: GitHub Actions workflow builds Docker image on push/tag
- [x] **CI-02**: Scheduled workflow detects new OpenNebula releases and triggers builds
- [x] **CI-03**: Images pushed to Docker Hub (pablodelarco/opennebula)
- [x] **CI-04**: Trivy vulnerability scanning fails build on CRITICAL/HIGH vulnerabilities
- [x] **CI-05**: Docker image tags align with OpenNebula version (e.g., 7.0.0, latest)

### Helm Chart

- [x] **HELM-01**: oned runs as StatefulSet with persistent volume for /var/lib/one
- [x] **HELM-02**: MariaDB deployed as subchart dependency
- [x] **HELM-03**: SSH keys stored in Kubernetes secrets, persist across restarts
- [x] **HELM-04**: OpenNebula config files managed via ConfigMaps
- [x] **HELM-05**: Liveness probe on oned API, readiness probe on service availability
- [x] **HELM-06**: FireEdge accessible via Ingress with configurable hostname
- [x] **HELM-07**: values.yaml allows customization of resources, persistence, ingress

## v1.1 Requirements

Production hardening based on real-world deployment feedback.

### Networking & Ports

- [x] **PROD-01**: Expose port 4124 UDP for monitoring (hypervisor probes)
- [x] **PROD-02**: Expose port 22 TCP for SSH transfer manager
- [x] **PROD-03**: Configure VNM for transparent proxy mode
- [x] **PROD-04**: Explicit hostname configuration for stable pod identity

## v2 Requirements (Deferred)

Deferred to future release. Tracked but not in current roadmap.

### Advanced Features

- **ADV-01**: VNC console access via Guacamole/noVNC integration
- **ADV-02**: Multi-arch Docker builds (amd64 + arm64)
- **ADV-03**: HA configuration with leader election for oned
- **ADV-04**: OneGate external service exposure for VM contextualization
- **ADV-05**: Prometheus metrics endpoint integration
- **ADV-06**: Backup and restore automation

## Out of Scope

Explicitly excluded. Documented to prevent scope creep.

| Feature | Reason |
|---------|--------|
| VMware/ESXi integration | Focus on KVM/LXC only per user requirements |
| OpenNebula Enterprise features | Community edition only |
| Hypervisor node deployment | Control plane only; hypervisors must be external to K8s |
| PostgreSQL backend | MariaDB is standard; PostgreSQL is "Technology Preview" |
| Legacy Ruby Sunstone only | FireEdge is the modern UI, include both |

## Traceability

Which phases cover which requirements.

| Requirement | Phase | Status |
|-------------|-------|--------|
| IMG-01 | Phase 1 | Complete |
| IMG-02 | Phase 1 | Complete |
| IMG-03 | Phase 1 | Complete |
| IMG-04 | Phase 1 | Complete |
| IMG-05 | Phase 1 | Complete |
| CI-01 | Phase 2 | Complete |
| CI-02 | Phase 2 | Complete |
| CI-03 | Phase 2 | Complete |
| CI-04 | Phase 2 | Complete |
| CI-05 | Phase 2 | Complete |
| HELM-01 | Phase 3 | Complete |
| HELM-02 | Phase 3 | Complete |
| HELM-03 | Phase 3 | Complete |
| HELM-04 | Phase 3 | Complete |
| HELM-05 | Phase 3 | Complete |
| HELM-06 | Phase 3 | Complete |
| HELM-07 | Phase 3 | Complete |
| PROD-01 | Phase 4 | Complete |
| PROD-02 | Phase 4 | Complete |
| PROD-03 | Phase 4 | Complete |
| PROD-04 | Phase 4 | Complete |

**Coverage:**
- v1 requirements: 17 total (all complete)
- v1.1 requirements: 4 total (all complete)
- Mapped to phases: 21
- Unmapped: 0

---

## Milestone Summary

**Shipped:** 21 of 21 requirements
**Adjusted:** None
**Dropped:** None

---
*Archived: 2026-02-03 as part of v1.1 milestone completion*
